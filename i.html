<body>
<button id='requestPermission'>requestPermission</button>
</body>
<script>
function requestPermission(){
if(!('serviceWorker' in navigator)){
  console.log('Service Worker not supported ');
  
  }
navigator.serviceWorker.register('/service-worker.js')
.then(function (registration) {
  console.log('Resistered successfully. Scope is: ' , registration.scope);
  });

Notification.requestPermission(status => {
console.log('Notification permission: ' , status);
});
  displayNotification();
}
function displayNotification() {
  navigator.serviceWorker.ready.then(
            (serviceWorkerRegistration) => {
                const options = {
                    userVisibleOnly: true,
                    applicationServerKey
                };
                serviceWorkerRegistration.pushManager.subscribe(options).then(
                 (pushSubscription) => {
                console.log(pushSubscription.endpoint);
                 // The push subscription details needed by the application
                 // server are now available, and can be sent to it using,
                // for example, an XMLHttpRequest.
                 }.catch(error) => {
                // During development it often helps to log errors to the
               // console. In a production environment it might make sense to
               // also report information about errors back to the
               // application server.
             console.error(error);
             });
            });
/*if(Notification.permission === 'granted') {
navigator.serviceWorker.getRegistration().then(reg => {
reg.pushManager.subscribe({
  userVisibleOnly: true
  }).then(sub => {
  console.log(sub.toJSON());
              });
});
  }*/
  }
  document.getElementById('requestPermission').addEventListener('click', requestPermission);
</script>
